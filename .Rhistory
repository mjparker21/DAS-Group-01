#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "paleturquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "paleturquoise4") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "turquoise4") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity, aes(x = Year, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity, aes(x = Year, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "cadetblue3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "cadetblue4") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "cadetblue3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity, aes(x = Year, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and Age group
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(position = 'dodge', fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and other factors
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Sex)) + geom_bar(fill = "skyblue4") +
labs(y = "Count")
p3 <- ggplot(obesity_sub, aes(x = Employment)) + geom_bar(fill = "slategray1") +
labs(y = "Count")
p1 + p2 +p3 +plot_layout(nrow = 2,ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and other factors
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Sex)) + geom_bar(fill = "skyblue4") +
labs(y = "Count")
p3 <- ggplot(obesity_sub, aes(x = Employment)) + geom_bar(fill = "slategray3") +
labs(y = "Count")
p1 + p2 +p3 +plot_layout(nrow = 2,ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and other factors
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Sex)) + geom_bar(fill = "skyblue4") +
labs(y = "Count")
p1+p2+plot_layout(nrow = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesiety and other factors
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Sex)) + geom_bar(fill = "skyblue4") +
labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Age Group and Sex
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Sex)) + geom_bar(fill = "skyblue4") +
labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = Fruit)) + geom_bar(fill = "steelblue3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Veg)) + geom_bar(fill = "paleturquoise3") +
labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Lifestyle Factors
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
p1 <- ggplot(obesity, aes(x = Fruit, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
p2 <- ggplot(obesity, aes(x = Veg, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Age Group and Sex
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity_sub, aes(x = Sex)) + geom_bar(fill = "skyblue4") +
labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Age Group and Sex
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity, aes(x = Sex, fill = Obese)) + geom_bar() + labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Age Group and Sex
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity, aes(x = Sex, fill = Obese)) + geom_bar(position = 'dodge') + labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Age Group and Sex
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
obesity_sub <- obesity |> dplyr::filter(Obese=="Yes")
p1 <- ggplot(obesity_sub, aes(x = AgeGroup)) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
p2 <- ggplot(obesity, aes(x = Sex, fill = Obese)) + geom_bar(position = 'dodge') + labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar2
#| fig-cap: Relationship between Obesity by Lifestyle Factors
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
p1 <- ggplot(obesity, aes(x = Fruit, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
p2 <- ggplot(obesity, aes(x = Veg, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
p1+p2+plot_layout(ncol = 2)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity, aes(x = Employment, fill=Obese)) + geom_bar(position = 'dodge') +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = Employment) + geom_bar(fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = Employment) + geom_bar(fill = "turquoise3")) +
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = Employment)) +
geom_bar(fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = as.factor(Employment)) +
geom_bar(fill = "turquoise3") +
labs(y = "Count")
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = Employment) +
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar1
#| fig-cap: Relationship between Obesiety and Year
#| fig-cap-location: margin
#| fig-align: center
#| fig-width: 4.5
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = Employment)) +
geom_bar(fill = "turquoise3") +
labs(y = "Count")
install.packages("stringr")
install.packages("stringr")
library(stringr)
#| echo: false
#| warning: false
#| message: false
#| label: fig-bar4
#| fig-cap: Relationship between Obesiety and Employment
#| fig-align: center
#| fig-height: 3.5
ggplot(obesity_sub, aes(x = Employment)) +
geom_bar(fill = "turquoise3") +
labs(y = "Count") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10))
<<<<<<< Updated upstream
=======
final.model <- glm(Obese ~ Veg + Sex * AgeGroup + Sex * Employment, family = 'binomial', data = obesity)
#| echo: false
#| warning: false
#| message: false
library(AICcmodavg)
install.packages("AICcmodavg")
#| echo: false
#| warning: false
#| message: false
library(AICcmodavg)
library(readr)
library(ggplot2)
library(ggfortify)
library(tidyverse)
library(tidymodels)
library(gt)
library(MASS)
library(patchwork)
library(moderndive)
library(stringr)
final.model <- glm(Obese ~ Veg + Sex * AgeGroup + Sex * Employment, family = 'binomial', data = obesity)
#| echo: false
#| warning: false
#| message: false
# change to factors
obesity$AgeGroup <- as.factor(obesity$AgeGroup)
obesity$Year <- as.factor(obesity$Year)
obesity$Sex <- as.factor(obesity$Sex)
obesity$Employment <- as.factor(obesity$Employment)
obesity$Veg <- as.factor(obesity$Veg)
obesity$Fruit <- as.factor(obesity$Fruit)
obesity$Obese <- as.factor(obesity$Obese)
final.model <- glm(Obese ~ Veg + Sex * AgeGroup + Sex * Employment, family = 'binomial', data = obesity)
summary(final.model)
full.int.model <- glm(Obese ~ .^2, data = obesity, family = 'binomial')
stepAIC(full.int.model, direction = "both")
#| echo: false
#| warning: false
#| message: false
library(AICcmodavg)
library(readr)
library(ggplot2)
library(ggfortify)
library(tidyverse)
library(tidymodels)
library(gt)
library(MASS)
library(patchwork)
library(moderndive)
library(stringr)
stepAIC(full.int.model, direction = "both")
mod.test <- glm(Obese~Veg*Sex*Employment*AgeGroup, data = obesity, family = "binomial")
#| echo: false
#| message: false
#| warning: false
#| label: tbl-regtable
#| tbl-cap: Estimates of the regression model coefficients.
#| warning: false
#| message: false
# change to factors
obesity$AgeGroup <- as.factor(obesity$AgeGroup)
obesity$Year <- as.factor(obesity$Year)
obesity$Sex <- as.factor(obesity$Sex)
obesity$Employment <- as.factor(obesity$Employment)
obesity$Veg <- as.factor(obesity$Veg)
obesity$Fruit <- as.factor(obesity$Fruit)
obesity$Obese <- as.factor(obesity$Obese)
final.model <- glm(Obese ~ Veg + Sex*AgeGroup + Employment, family = 'binomial', data = obesity)
#test
mod.test <- glm(Obese~Veg*Sex*Employment*AgeGroup, data = obesity, family = "binomial")
summary(mod.test)
#test
mod.test <- glm(Obese~.^2-Year-Fruit, data = obesity, family = "binomial")
summary(mod.test)
AIC.model <- stepAIC(mod.test,direction = "both")
obesiety.sub2 <- obesity |> select("Obese","Veg","Sex","Employment","AgeGroup")
#test
obesiety.sub2 <- obesity |> select(Obese,Veg,Sex,Employment,AgeGroup)
obesiety.sub2 <- obesity |> select(Obese,Veg,Sex,Employment,AgeGroup)
obesiety.sub2 <- obesity |> select(Obese,Veg,Sex,Employment,AgeGroup)
obesiety.sub2 <- obesity |> dplyr::select(Obese,Veg,Sex,Employment,AgeGroup)
#test
obesiety.sub2 <- obesity |> dplyr::select(Obese,Veg,Sex,Employment,AgeGroup)
mod.test <- glm(Obese~.^2, data = obesity.sub2, family = "binomial")
#test
obesity.sub2 <- obesity |> dplyr::select(Obese,Veg,Sex,Employment,AgeGroup)
mod.test <- glm(Obese~.^2, data = obesity.sub2, family = "binomial")
AIC.model <- stepAIC(mod.test,direction = "both")
summary(AIC.model)
summary(final.model)
final.model <- glm(Obese ~ Veg + Sex * AgeGroup + Sex * Employment, family = 'binomial', data = obesity)
summary(final.model)
>>>>>>> Stashed changes
